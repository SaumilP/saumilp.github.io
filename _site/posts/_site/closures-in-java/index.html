<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>

        Closures in Java &middot; Saumil Patel

    </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/all.min.css">
    <!--
  <link rel="stylesheet" href="/assets/css/poole.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <link rel="stylesheet" href="/assets/css/lanyon.css">
  <link rel="stylesheet" href="/assets/css/custom.css">
  -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-precomposed.png">
    <link rel="shortcut icon" href="/assets/favicon.ico">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

    <link rel="canonical" href="/posts/closures-in-java/" />

    <script async src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="/bower_components/jquery/dist/jquery.min.js"><\/script>')
    </script>

</head>


<script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-59409595-1', 'auto');
    ga('send', 'pageview');
</script>


<body class="theme-base-08">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

    <!-- Toggleable sidebar -->
    <div class="sidebar" id="sidebar">
        <br>
        <div class="smallerCircularProfilePic"></div>

        <div class="sidebar-item" style="text-align:center">
            <p>Code, Thoughts and Ideas</p>
        </div>

        <nav class="sidebar-nav" style="text-align:center">
            <a class="sidebar-nav-item" href="/">Home</a>









            <a class="sidebar-nav-item" href="/about.html">About Me</a>





            <a class="sidebar-nav-item" href="/archive.html">Archive</a>











            <a class="sidebar-nav-item" href="/about/index.html">About</a>







            <a class="sidebar-nav-item" href="/tags.html">Tags</a>












            <!--     <a class="sidebar-nav-item" href="https://github.com/SaumilP/archive/v.zip">Download</a> -->
            <!--<a class="sidebar-nav-item" href="https://github.com/SaumilP">GitHub project</a>-->
            <a class="sidebar-nav-item" target="_blank" href="">Feedback</a>
        </nav>

        <div class="sidebar-item" style="text-align:center">
            <p>
                <span id="ga-totalpageviews"></span>
            </p>

            <p>
                &copy; 2018. Saumil Patel.
            </p>
            All rights reserved.
        </div>
    </div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
        <div class="masthead">
            <div class="container" style="text-align:center">
                <h3 class="masthead-title">
                    <a href="/" title="Home">codeground</a>
                    <small>coding.isFun()</small>
                </h3>
            </div>
        </div>

        <div class="container content">
            <ul class="tags">

                <li><a href="/tags.html#closures" class="tag">closures</a></li>

                <li><a href="/tags.html#functions" class="tag">functions</a></li>

            </ul>

            <div class="post">
                <h1 class="post-title">Closures in Java</h1>
                <div>
                    <span class="post-date" style="float: left;">23 Jan 2015</span>
                    <span class="post-date" style="float: right;" id="ga-pageviews"></span>
                </div>
                <div style="clear: both;"></div>​

                <p>Working on last few projects, i’ve realized that use of closures can come really handy in day-to-day work. Can you imagine writing loops after loops to extract or collect properties from list of custom objects? It can be tiring and painful.
                    And hence, I have decided to add this post - mainly to point out couple of situations where introduction to closures can really ease this pain.</p>

                <p>Most of you must have used <a href="https://projectlombok.org"><i>Project Lambok</i></a> or <i>Functional Java</i> to achive this. Unfortunately not everyone gets the choice to be able to use opensource libraries. Yeah, there are clients
                    who prefers to avoid use of opensource libraries in this day and age, can you believe it ? Anyways, i have tried to point out some of the features offerred by closures in this post.</p>

                <p>Before going forward in more details, let’s try and understand what closures mean in Java and what it can bring on the table. A Closure is a first class function or reference to a function together with a referencing environment. Most
                    of the time, function types, anonumous functions and inline function-valued expressions are also refered as closures in java. An anonymous function that contains some context surrounding it as a snapshot &amp; can be passed as a parameter.
                    The definition of closure can be broken down into two main parts - callbacks and contextual information surrounding this callback function.</p>

                <p>Please note, Anonymous classes in java are close to being called as closures, but they do not fully support definition of closure. But they come close to it and hence you can find lot of literature calling anonymous inner classes as closures.
                    The main reason behind not supporting definition, is due to the fact that inner class can only access <strong><i>final</i></strong> local variable of the enclosing method. And also, because these variables get created and stored in
                    a stack, they get destroyed when execution of the method completes and result gets returned. And If you want to make an anonymous inner class as a closure, it should be allowed to access all the fields surrounding body - which is not
                    permissible by current memory management.</p>

                <p>Enough with the explanation, let’s look at some of the examples!</p>

                <p>In pre Java 8, versions we can simulate closures</p>

                <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Funct</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="kd">public</span> <span class="n">B</span> <span class="nf">func</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">);</span>
<span class="o">}</span></code></pre></div>

                <p>We can use this interface to emulate anonymous inner class easily. Below mentioned methods can be used to perform simple comparison tasks and can be later extended to combine with interface <code>Funct&lt;A,B&gt;</code> to simulate closures.</p>

                <p>Method to retrieve larger values compared to provided comparison value:</p>

                <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">larger</span><span class="o">(</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">objectList</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Integer</span> <span class="n">refObj</span> <span class="o">){</span>
	<span class="k">for</span><span class="o">(</span> <span class="n">Integer</span> <span class="n">comparedObj</span> <span class="o">:</span> <span class="n">objectList</span> <span class="o">){</span>
		<span class="k">if</span><span class="o">(</span> <span class="n">comaredObj</span> <span class="o">&gt;</span> <span class="n">refObj</span> <span class="o">){</span>
			<span class="k">return</span> <span class="n">comparedObj</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="k">return</span> <span class="n">refObj</span><span class="o">;</span>
<span class="o">}</span></code></pre></div>

                <p>Another method to determine smaller value compared to provided comparison value:</p>

                <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">smaller</span><span class="o">(</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">objectList</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Integer</span> <span class="n">refObj</span> <span class="o">){</span>
	<span class="k">for</span><span class="o">(</span> <span class="n">Integer</span> <span class="n">comparedObj</span> <span class="o">:</span> <span class="n">objectList</span> <span class="o">){</span>
		<span class="k">if</span><span class="o">(</span> <span class="n">comparedObj</span> <span class="o">&lt;</span> <span class="n">refObj</span> <span class="o">){</span>
			<span class="k">return</span> <span class="n">comparedObj</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="k">return</span> <span class="n">refObj</span><span class="o">;</span>
<span class="o">}</span></code></pre></div>

                <p>These method are very identical - except the conditions. These can be combined using above mentioned interface like this:</p>

                <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">firstMatch</span><span class="o">(</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">objectList</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Funct</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">functor</span><span class="o">,</span> <span class="n">T</span> <span class="n">refObj</span> <span class="o">){</span>
	<span class="k">for</span><span class="o">(</span> <span class="n">T</span> <span class="n">comparedObj</span> <span class="o">:</span> <span class="n">objectList</span> <span class="o">){</span>
		<span class="k">if</span><span class="o">(</span><span class="n">functor</span><span class="o">.</span><span class="na">func</span><span class="o">(</span><span class="n">comparedObj</span><span class="o">)){</span>
			<span class="k">return</span> <span class="n">comparedObj</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="k">return</span> <span class="n">refObj</span><span class="o">;</span>
<span class="o">}</span></code></pre></div>

                <p>This method can be used as :</p>

                <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Func</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">greaterThanFive</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Func</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;{</span>
	<span class="n">Boolean</span> <span class="nf">func</span><span class="o">(</span><span class="n">Integer</span> <span class="n">no</span><span class="o">){</span>
		<span class="k">return</span> <span class="n">no</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

<span class="kt">int</span> <span class="n">numbersBiggerThanFive</span> <span class="o">=</span> <span class="n">firstMatch</span><span class="o">(</span> <span class="n">someIntegerList</span><span class="o">,</span> <span class="n">greaterThanFive</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">);</span></code></pre></div>

                <p>Other few examples can be found in (progfun)[https://github.com/SaumilP/java-progfun].</p>

                <p>In Java 8, streams can be used to make use of newly added feature - lambda expressions.</p>

                <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="n">Integer</span> <span class="n">noBiggerThanFive</span> <span class="o">=</span> <span class="n">someList</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">no</span> <span class="o">-&gt;</span> <span class="n">no</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="o">).</span><span class="na">get</span><span class="o">();</span></code></pre></div>

                <p>It is less verbose compared to older version of the code, but it gives neat and short presentation of the code. Developers can focus more on the work getting done instead of worrying about getting syntax correct.</p>

                <p>I will add more Java 8 examples in next post.</p>

            </div>
            <span class="post-date">Share this blog: </span>
            <!-- Go to www.addthis.com/dashboard to customize your tools -->

            <script type="text/javascript">
                var addthis_config = {
                    pubid: "ra-54cdd2703320cb27"
                }
            </script>

            <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

            <div class="addthis_sharing_toolbox"></div>
            <script type="text/javascript">
                var addthis_share = addthis_share || {}
                addthis_share = {
                    passthrough: {
                        twitter: {
                            via: "SaumilP10"
                        }
                    }
                }
            </script>


            <div class="related">
                <h2>Related Posts</h2>
                <ul class="related-posts">

                    <li>
                        <h3>
                            <a href="/posts/solr-performance-improvements/">
            Quick Solr Setup
            <small>25 Apr 2015</small>
          </a>
                        </h3>
                    </li>

                    <li>
                        <h3>
                            <a href="/posts/unique-id-generation-in-solr/">
            Automatic ID generation in Apache Solr
            <small>16 Feb 2015</small>
          </a>
                        </h3>
                    </li>

                    <li>
                        <h3>
                            <a href="/posts/xml-schema-design-patterns/">
            XML Schema Design Patterns
            <small>09 Feb 2015</small>
          </a>
                        </h3>
                    </li>

                </ul>
            </div>



            <!-- Add Disqus comments. -->
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'SaumilP';

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script');
                    dsq.type = 'text/javascript';
                    dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



        </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
        (function(document) {
            var toggle = document.querySelector('.sidebar-toggle');
            var sidebar = document.querySelector('#sidebar');
            var checkbox = document.querySelector('#sidebar-checkbox');

            document.addEventListener('click', function(e) {
                var target = e.target;

                if (!checkbox.checked ||
                    sidebar.contains(target) ||
                    (target === checkbox || target === toggle)) return;

                checkbox.checked = false;
            }, false);
        })(document);
    </script>

    <script>
        var jqxhr = $.ajax("")
            .done(function(response) {
                if (response !== undefined) {
                    var page_url = "/posts/closures-in-java/";
                    var page_views = undefined;
                    var total_views = undefined;
                    var oPageViews = {};

                    var total_views = response.totalsForAllResults['ga:pageviews'];

                    var pagePathIndex;
                    var pageViewsIndex;

                    function findColumnHeaders(element, index, array) {
                        switch (element.name) {
                            case "ga:pagePath":
                                pagePathIndex = index;
                                return;
                            case "ga:pageviews":
                                pageViewsIndex = index;
                                return;
                        }
                    }

                    response.columnHeaders.forEach(findColumnHeaders);

                    if (total_views !== undefined && total_views !== null && $("#ga-totalpageviews-div")) {
                        $("#ga-totalpageviews").html("Views: " + total_views);
                    }

                    if (response.rows !== undefined) {
                        jQuery.each(response.rows, function(index, row) {
                            var ga_page_url = row[pagePathIndex];
                            if (page_url.lastIndexOf("/") === (page_url.length - 1)) {
                                page_url = page_url + "index.html";
                            }
                            if (ga_page_url === page_url) {
                                page_views = row[pageViewsIndex];
                                if (page_views !== undefined && page_views !== null && $("#ga-pageviews-div")) {
                                    $("#ga-pageviews").html("Views: " + page_views);
                                }
                            }

                            oPageViews[ga_page_url] = row[pageViewsIndex];

                        });

                        $('span[data-post-url]').each(function(index) {
                            var dataPostUrl = $(this).attr("data-post-url");
                            if (dataPostUrl.lastIndexOf("/") === (dataPostUrl.length - 1)) {
                                dataPostUrl = dataPostUrl + "index.html";
                            }

                            if (oPageViews[dataPostUrl] !== undefined && oPageViews[dataPostUrl] !== null) {
                                $(this).html("Views: " + oPageViews[dataPostUrl]);
                            }

                        });
                    }
                }
            })
            .fail(function(error) {
                console.log("Failed to get GA data");
            });
    </script>


</body>

</html>